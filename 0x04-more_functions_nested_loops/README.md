 functions and nested loops applied
